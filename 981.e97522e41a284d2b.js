"use strict";(self.webpackChunkdemo_app=self.webpackChunkdemo_app||[]).push([[981],{5635:(Q,P,c)=>{function k(R){window.katoid&&window.katoid.recordEvent(R),window.gtag&&window.gtag("event",R)}c.d(P,{V:()=>k})},9046:(Q,P,c)=>{c.d(P,{f:()=>x});var k=c(6814),R=c(1488),d=c(5879);const E=function(){return["/playground"]},_=function(){return["/custom-handles"]},H=function(){return["/real-life-example"]},z=function(){return["/scroll-test"]},g=function(){return["/row-height-fit"]};let x=(()=>{class p{constructor(){}static#t=this.\u0275fac=function(v){return new(v||p)};static#e=this.\u0275cmp=d.Xpm({type:p,selectors:[["ktd-footer"]],standalone:!0,features:[d.jDz],decls:13,vars:10,consts:[[2,"margin-top","16px"],[2,"display","flex","flex-direction","column"],[3,"routerLink"]],template:function(v,T){1&v&&(d.TgZ(0,"h2",0),d._uU(1,"Other examples: "),d.qZA(),d.TgZ(2,"div",1)(3,"a",2),d._uU(4,"Playground"),d.qZA(),d.TgZ(5,"a",2),d._uU(6,"Custom handles"),d.qZA(),d.TgZ(7,"a",2),d._uU(8,"Real life example"),d.qZA(),d.TgZ(9,"a",2),d._uU(10,"Scroll test"),d.qZA(),d.TgZ(11,"a",2),d._uU(12,"Row Height Fit"),d.qZA()()),2&v&&(d.xp6(3),d.Q6J("routerLink",d.DdM(5,E)),d.xp6(2),d.Q6J("routerLink",d.DdM(6,_)),d.xp6(2),d.Q6J("routerLink",d.DdM(7,H)),d.xp6(2),d.Q6J("routerLink",d.DdM(8,z)),d.xp6(2),d.Q6J("routerLink",d.DdM(9,g)))},dependencies:[k.ez,R.Bz,R.rH],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   a[_ngcontent-%COMP%]{align-self:start;display:flex}"]})}return p})()},9016:(Q,P,c)=>{c.d(P,{R:()=>H});var k=c(4699),R=c(1280),d=c(8594),E=c(6124);function H(f,C,v,T){return(0,d.m)(v)&&(T=v,v=void 0),T?H(f,C,v).pipe((0,E.U)(D=>(0,R.k)(D)?T(...D):T(D))):new k.y(D=>{z(f,C,function A(M){D.next(arguments.length>1?Array.prototype.slice.call(arguments):M)},D,v)})}function z(f,C,v,T,D){let A;if(function p(f){return f&&"function"==typeof f.addEventListener&&"function"==typeof f.removeEventListener}(f)){const M=f;f.addEventListener(C,v,D),A=()=>M.removeEventListener(C,v,D)}else if(function x(f){return f&&"function"==typeof f.on&&"function"==typeof f.off}(f)){const M=f;f.on(C,v),A=()=>M.off(C,v)}else if(function g(f){return f&&"function"==typeof f.addListener&&"function"==typeof f.removeListener}(f)){const M=f;f.addListener(C,v),A=()=>M.removeListener(C,v)}else{if(!f||!f.length)throw new TypeError("Invalid event target");for(let M=0,pt=f.length;M<pt;M++)z(f[M],C,v,T,D)}T.add(A)}},3944:(Q,P,c)=>{c.d(P,{Z:()=>_});var k=c(1618),d=c(1781);const _=new class E extends d.v{flush(g){this.active=!0,this.scheduled=void 0;const{actions:x}=this;let p,f=-1,C=x.length;g=g||x.shift();do{if(p=g.execute(g.state,g.delay))break}while(++f<C&&(g=x.shift()));if(this.active=!1,p){for(;++f<C&&(g=x.shift());)g.unsubscribe();throw p}}}(class R extends k.o{constructor(g,x){super(g,x),this.scheduler=g,this.work=x}requestAsyncId(g,x,p=0){return null!==p&&p>0?super.requestAsyncId(g,x,p):(g.actions.push(this),g.scheduled||(g.scheduled=requestAnimationFrame(()=>g.flush(null))))}recycleAsyncId(g,x,p=0){if(null!==p&&p>0||null===p&&this.delay>0)return super.recycleAsyncId(g,x,p);0===g.actions.length&&(cancelAnimationFrame(x),g.scheduled=void 0)}})},6745:(Q,P,c)=>{c.d(P,{k:()=>R});var k=c(1280);function R(d){return!(0,k.k)(d)&&d-parseFloat(d)+1>=0}},9700:(Q,P,c)=>{c.d(P,{Vh:()=>Ue,D9:()=>Pe,Mc:()=>Ut,Rm:()=>_e,SQ:()=>Ze,ZE:()=>ke,zk:()=>we,Yy:()=>ve});var k=c(4917),R=c(1226);function d(t,e=R.E,n=R.E){return(0,k.P)(()=>t()?e:n)}var E=c(9016),_=c(7354),H=c(4699),z=c(2079),g=c(5125),x=c(9918);const p=new H.y(x.Z);var C=c(435),v=c(6745);function D(t){const{subscriber:e,counter:n,period:i}=t;e.next(n),this.schedule({subscriber:e,counter:n+1,period:i},i)}var A=c(3944),M=c(2994),pt=c(9193),G=c(7734),Z=c(5222),rt=c(3075),W=c(6124),qt=c(5253),mt=c(5846);function yt(t,e){return e?n=>n.pipe(yt((i,r)=>(0,qt.D)(t(i,r)).pipe((0,W.U)((o,s)=>e(i,o,r,s))))):n=>n.lift(new te(t))}class te{constructor(e){this.project=e}call(e,n){return n.subscribe(new ee(e,this.project))}}class ee extends mt.Ds{constructor(e,n){super(e),this.project=n,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}_next(e){this.hasSubscription||this.tryNext(e)}tryNext(e){let n;const i=this.index++;try{n=this.project(e,i)}catch(r){return void this.destination.error(r)}this.hasSubscription=!0,this._innerSub(n)}_innerSub(e){const n=new mt.IY(this),i=this.destination;i.add(n);const r=(0,mt.ft)(e,n);r!==n&&i.add(r)}_complete(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}var vt=c(9352),ne=c(1418),Ht=c(7927),ie=c(2068),a=c(5879);const re=["resizeElem"],zt=["*"],oe=!1;function Tt(t){const e={w:t.w,h:t.h,x:t.x,y:t.y,id:t.id,moved:!!t.moved,static:!!t.static};return void 0!==t.minW&&(e.minW=t.minW),void 0!==t.maxW&&(e.maxW=t.maxW),void 0!==t.minH&&(e.minH=t.minH),void 0!==t.maxH&&(e.maxH=t.maxH),void 0!==t.isDraggable&&(e.isDraggable=t.isDraggable),void 0!==t.isResizable&&(e.isResizable=t.isResizable),e}function wt(t,e){return!(t.id===e.id||t.x+t.w<=e.x||t.x>=e.x+e.w||t.y+t.h<=e.y||t.y>=e.y+e.h)}function ot(t,e,n){const i=function Ot(t){return t.filter(e=>e.static)}(t),r=Lt(t,e),o=Array(t.length);for(let s=0,l=r.length;s<l;s++){let h=Tt(r[s]);h.static||(h=le(i,h,e,n,r),i.push(h)),o[t.indexOf(r[s])]=h,h.moved=!1}return o}const ae={x:"w",y:"h"};function bt(t,e,n,i){const r=ae[i];e[i]+=1;const o=t.map(s=>s.id).indexOf(e.id);for(let s=o+1;s<t.length;s++){const l=t[s];if(!l.static){if(l.y>e.y+e.h)break;wt(e,l)&&bt(t,l,n+e[r],i)}}e[i]=n}function le(t,e,n,i,r){const s="horizontal"===n;if("vertical"===n)for(e.y=Math.min(function se(t){let n,e=0;for(let i=0,r=t.length;i<r;i++)n=t[i].y+t[i].h,n>e&&(e=n);return e}(t),e.y);e.y>0&&!Y(t,e);)e.y--;else if(s)for(;e.x>0&&!Y(t,e);)e.x--;let l;for(;l=Y(t,e);)if(s?bt(r,e,l.x+l.w,"x"):bt(r,e,l.y+l.h,"y"),s&&e.x+e.w>i)for(e.x=i-e.w,e.y++;e.x>0&&!Y(t,e);)e.x--;return e.y=Math.max(e.y,0),e.x=Math.max(e.x,0),e}function Y(t,e){for(let n=0,i=t.length;n<i;n++)if(wt(t[n],e))return t[n];return null}function xt(t,e,n,i,r,o,s,l){if(e.static&&!0!==e.isDraggable||e.y===i&&e.x===n)return t;st(`Moving element ${e.id} to [${String(n)},${String(i)}] from [${e.x},${e.y}]`);const h=e.x,y=e.y;"number"==typeof n&&(e.x=n),"number"==typeof i&&(e.y=i),e.moved=!0;let w=Lt(t,s);("vertical"===s&&"number"==typeof i?y>=i:"horizontal"===s&&"number"==typeof n&&h>=n)&&(w=w.reverse());const I=function de(t,e){return t.filter(n=>wt(n,e))}(w,e);if(o&&I.length)return st(`Collision prevented on ${e.id}, reverting.`),e.x=h,e.y=y,e.moved=!1,t;for(let m=0,U=I.length;m<U;m++){const S=I[m];st(`Resolving collision between ${e.id} at [${e.x},${e.y}] and ${S.id} at [${S.x},${S.y}]`),!S.moved&&(t=S.static?Gt(t,S,e,r,s,l):Gt(t,e,S,r,s,l))}return t}function Gt(t,e,n,i,r,o){const s="horizontal"===r,l="horizontal"!==r,h=e.static;if(i){i=!1;const y={x:s?Math.max(e.x-n.w,0):n.x,y:l?Math.max(e.y-n.h,0):n.y,w:n.w,h:n.h,id:"-1"};if(!Y(t,y))return st(`Doing reverse collision on ${n.id} up to [${y.x},${y.y}].`),xt(t,n,s?y.x:void 0,l?y.y:void 0,i,h,r,o)}return xt(t,n,s?n.x+1:void 0,l?n.y+1:void 0,i,h,r,o)}function Lt(t,e){return"horizontal"===e?function he(t){return[].concat(t).sort(function(e,n){return e.x>n.x||e.x===n.x&&e.y>n.y?1:-1})}(t):function ce(t){return[].concat(t).sort(function(e,n){return e.y>n.y||e.y===n.y&&e.x>n.x?1:e.y===n.y&&e.x===n.x?0:-1})}(t)}function st(...t){oe&&console.log(...t)}let N;function at(t){return function ue(){if(null==N&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>N=!0}))}finally{N=N||!1}return N}()?t:!!t.capture}const fe=at({passive:!0}),j=at({passive:!1});let lt=null;function dt(){if(null!=lt)return lt;const t=/Android|webOS|BlackBerry|Windows Phone|iPad|iPhone|iPod/i.test(navigator.userAgent),e=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return lt=t||e,lt}function ct(t){return null!=t.clientX}function J(t){return ct(t)?t.clientX:t.touches[0].clientX}function q(t){return ct(t)?t.clientY:t.touches[0].clientY}function It(t){return{clientX:ct(t)?t.clientX:t.touches[0].clientX,clientY:ct(t)?t.clientY:t.touches[0].clientY}}function $t(t){return"mousedown"===t.type||"pointerdown"===t.type&&"mouse"===t.pointerType}function ht(){return!!window.PointerEvent}function ut(t){return ht()?(0,E.R)(t,"pointerdown",j).pipe((0,G.h)(e=>e.isPrimary)):function ge(t,e=1){return d(()=>dt(),(0,E.R)(t,"touchstart",fe).pipe((0,G.h)(n=>n.touches.length===e)),(0,E.R)(t,"mousedown",j).pipe((0,G.h)(n=>0===n.button)))}(t)}function Ct(t){return ht()?(0,E.R)(t,"pointerup").pipe((0,G.h)(e=>e.isPrimary)):function ye(t,e=1){return d(()=>dt(),function me(t,e=1){return(0,_.T)((0,E.R)(t,"touchend").pipe((0,G.h)(n=>n.touches.length===e-1)),(0,E.R)(t,"touchcancel").pipe((0,G.h)(n=>n.touches.length===e-1)))}(t,e),(0,E.R)(t,"mouseup"))}(t)}function ve(t,e){return e.id}function ft(t,e,n){const i=t.reduce((s,l)=>Math.max(s,Math.max(l.y+l.h,0)),0);return(e-(i-1)*n)/i}function we(t,e,n){return ot(t,e,n).map(i=>({id:i.id,x:i.x,y:i.y,w:i.w,h:i.h,minW:i.minW,minH:i.minH,maxW:i.maxW,maxH:i.maxH}))}function be(t,e,n,i){return Math.round(t/((n-(n-i*(e-1))/e)/(e-1)))}function xe(t,e,n,i){return Math.round(t/(e+i))}function Ce(t,e,n,i){const o=(n-i*(e-1))/e;return Math.round((t-o)/(o+i))+1}function Ee(t,e,n,i){return Math.round((t-e)/(e+i))+1}function Re(t,e,n,i){const{pointerDownEvent:r,pointerDragEvent:o,gridElemClientRect:s,dragElemClientRect:l,scrollDifference:h}=i,y=t.id,w=e.layout.find(_t=>_t.id===y),L=J(r),I=q(r),m=J(o),U=q(o),B=m-(s.left+h.left)-(L-l.left),u=U-(s.top+h.top)-(I-l.top),it="fit"===e.rowHeight?ft(e.layout,e.height??s.height,e.gap):e.rowHeight,b={...w,x:be(B,e.cols,s.width,e.gap),y:xe(u,it,0,e.gap)};b.x=Math.max(0,b.x),b.y=Math.max(0,b.y),b.x+b.w>e.cols&&(b.x=Math.max(0,e.cols-b.w));const F=e.layout,O=F.find(_t=>_t.id===y);let $=xt(F,O,b.x,b.y,!0,e.preventCollision,n,e.cols);return $=ot($,n,e.cols),{layout:$,draggedItemPos:{top:u,left:B,width:l.width,height:l.height}}}function Se(t,e,n,i){const{pointerDownEvent:r,pointerDragEvent:o,gridElemClientRect:s,dragElemClientRect:l,scrollDifference:h}=i,y=t.id,w=J(r),L=q(r),I=J(o),m=q(o),U=l.width-(w-l.left),S=l.height-(L-l.top),nt=e.layout.find(b=>b.id===y),X=I+U-(l.left+h.left),V=m+S-(l.top+h.top),B="fit"===e.rowHeight?ft(e.layout,e.height??s.height,e.gap):e.rowHeight,u={...nt,w:Ce(X,e.cols,s.width,e.gap),h:Ee(V,B,0,e.gap)};if(u.w=At(u.w,t.minW??u.minW,t.maxW??u.maxW),u.h=At(u.h,t.minH??u.minH,t.maxH??u.maxH),u.x+u.w>e.cols&&(u.w=Math.max(1,e.cols-u.x)),e.preventCollision){const b=u.w,F=u.h;let $,O=K(e.layout,u);for(;O;)$=De(u,$),u[$]--,O=K(e.layout,u);if("w"===$)for(u.h=F,O=K(e.layout,u);O;)u.h--,O=K(e.layout,u);if("h"===$)for(u.w=b,O=K(e.layout,u);O;)u.w--,O=K(e.layout,u)}return{layout:ot(e.layout.map(b=>b.id===y?u:b),n,e.cols),draggedItemPos:{top:l.top-s.top,left:l.left-s.left,width:X,height:V}}}function K(t,e){return!!Y(t,e)}function De(t,e){return t.h<=1?"w":t.w<=1||"w"===e?"h":"w"}function At(t,e=1,n=1/0){return Math.min(Math.max(t,e<1?1:e),n)}const Wt=new a.OlP("KtdGridDragHandle");let Pe=(()=>{class t{constructor(n){this.element=n}static#t=this.\u0275fac=function(i){return new(i||t)(a.Y36(a.SBq))};static#e=this.\u0275dir=a.lG2({type:t,selectors:[["","ktdGridDragHandle",""]],hostAttrs:[1,"ktd-grid-drag-handle"],standalone:!0,features:[a._Bn([{provide:Wt,useExisting:t}])]})}return t})();const Bt=new a.OlP("KtdGridResizeHandle");let ke=(()=>{class t{constructor(n){this.element=n}static#t=this.\u0275fac=function(i){return new(i||t)(a.Y36(a.SBq))};static#e=this.\u0275dir=a.lG2({type:t,selectors:[["","ktdGridResizeHandle",""]],hostAttrs:[1,"ktd-grid-resize-handle"],standalone:!0,features:[a._Bn([{provide:Bt,useExisting:t}])]})}return t})();const Ft=new a.OlP("KtdGridItemPlaceholder");let _e=(()=>{class t{constructor(n){this.templateRef=n}static#t=this.\u0275fac=function(i){return new(i||t)(a.Y36(a.Rgc))};static#e=this.\u0275dir=a.lG2({type:t,selectors:[["ng-template","ktdGridItemPlaceholder",""]],hostAttrs:[1,"ktd-grid-item-placeholder-content"],inputs:{data:"data"},standalone:!0,features:[a._Bn([{provide:Ft,useExisting:t}])]})}return t})();function gt(t){return null!=t&&"false"!=`${t}`}function tt(t,e=0){return function He(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):e}const Yt=new a.OlP("GRID_ITEM_GET_RENDER_DATA_TOKEN"),Et=at({passive:!1,capture:!0});let Rt=(()=>{class t{constructor(n){this.ngZone=n,this.touchMoveSubject=new z.xQ,this.touchMove$=this.touchMoveSubject.asObservable(),this.registerTouchMoveSubscription()}ngOnDestroy(){this.touchMoveSubscription.unsubscribe()}mouseOrTouchMove$(n){return ht()?(0,E.R)(n,"pointermove",Et):d(()=>dt(),this.touchMove$,(0,E.R)(n,"mousemove",Et))}registerTouchMoveSubscription(){this.touchMoveSubscription=this.ngZone.runOutsideAngular(()=>(0,E.R)(document,"touchmove",Et).pipe((0,G.h)(n=>1===n.touches.length)).subscribe(n=>this.touchMoveSubject.next(n)))}static#t=this.\u0275fac=function(i){return new(i||t)(a.LFG(a.R0b))};static#e=this.\u0275prov=a.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Ut=(()=>{class t{get touchAction(){return this._draggable?"none":"auto"}get id(){return this._id}set id(n){this._id=n}get dragStartThreshold(){return this._dragStartThreshold}set dragStartThreshold(n){this._dragStartThreshold=tt(n)}get draggable(){return this._draggable}set draggable(n){this._draggable=gt(n),this._draggable$.next(this._draggable)}get resizable(){return this._resizable}set resizable(n){this._resizable=gt(n),this._resizable$.next(this._resizable)}constructor(n,i,r,o,s){this.elementRef=n,this.gridService=i,this.renderer=r,this.ngZone=o,this.getItemRenderData=s,this.transition="transform 500ms ease, width 500ms ease, height 500ms ease",this._dragStartThreshold=0,this._draggable=!0,this._draggable$=new g.X(this._draggable),this._manualDragEvents$=new z.xQ,this._resizable=!0,this._resizable$=new g.X(this._resizable),this.dragStartSubject=new z.xQ,this.resizeStartSubject=new z.xQ,this.subscriptions=[],this.dragStart$=this.dragStartSubject.asObservable(),this.resizeStart$=this.resizeStartSubject.asObservable()}ngOnInit(){const n=this.getItemRenderData(this.id);this.setStyles(n)}ngAfterContentInit(){this.subscriptions.push(this._dragStart$().subscribe(this.dragStartSubject),this._resizeStart$().subscribe(this.resizeStartSubject))}ngOnDestroy(){this.subscriptions.forEach(n=>n.unsubscribe())}startDragManually(n){this._manualDragEvents$.next(n)}setStyles({top:n,left:i,width:r,height:o}){this.renderer.setStyle(this.elementRef.nativeElement,"transform",`translateX(${i}) translateY(${n})`),this.renderer.setStyle(this.elementRef.nativeElement,"display","block"),this.renderer.setStyle(this.elementRef.nativeElement,"transition",this.transition),null!=r&&this.renderer.setStyle(this.elementRef.nativeElement,"width",r),null!=o&&this.renderer.setStyle(this.elementRef.nativeElement,"height",o)}_dragStart$(){return(0,_.T)(this._manualDragEvents$,this._draggable$.pipe((0,Z.w)(n=>n?this._dragHandles.changes.pipe((0,rt.O)(this._dragHandles),(0,Z.w)(i=>d(()=>i.length>0,(0,_.T)(...i.toArray().map(r=>ut(r.element.nativeElement))),ut(this.elementRef.nativeElement)))):p))).pipe(yt(n=>{$t(n)&&n.preventDefault();const i=It(n);return this.gridService.mouseOrTouchMove$(document).pipe((0,vt.R)(Ct(document)),function ze(t){return e=>new H.y(n=>t.runOutsideAngular(()=>e.subscribe(n)))}(this.ngZone),(0,G.h)(r=>{r.preventDefault();const o=It(r);return Math.abs(i.clientX-o.clientX)+Math.abs(i.clientY-o.clientY)>=this.dragStartThreshold}),(0,ne.q)(1),(0,W.U)(()=>n))}))}_resizeStart$(){return this._resizable$.pipe((0,Z.w)(n=>n?this._resizeHandles.changes.pipe((0,rt.O)(this._resizeHandles),(0,Z.w)(i=>i.length>0?(this.renderer.setStyle(this.resizeElem.nativeElement,"display","none"),(0,_.T)(...i.toArray().map(r=>ut(r.element.nativeElement)))):(this.renderer.setStyle(this.resizeElem.nativeElement,"display","block"),ut(this.resizeElem.nativeElement))),(0,Ht.b)(i=>{$t(i)&&i.preventDefault()})):(this.renderer.setStyle(this.resizeElem.nativeElement,"display","none"),p)))}static#t=this.\u0275fac=function(i){return new(i||t)(a.Y36(a.SBq),a.Y36(Rt),a.Y36(a.Qsj),a.Y36(a.R0b),a.Y36(Yt))};static#e=this.\u0275cmp=a.Xpm({type:t,selectors:[["ktd-grid-item"]],contentQueries:function(i,r,o){if(1&i&&(a.Suo(o,Ft,5),a.Suo(o,Wt,5),a.Suo(o,Bt,5)),2&i){let s;a.iGM(s=a.CRH())&&(r.placeholder=s.first),a.iGM(s=a.CRH())&&(r._dragHandles=s),a.iGM(s=a.CRH())&&(r._resizeHandles=s)}},viewQuery:function(i,r){if(1&i&&a.Gf(re,7,a.SBq),2&i){let o;a.iGM(o=a.CRH())&&(r.resizeElem=o.first)}},hostVars:2,hostBindings:function(i,r){2&i&&a.Udp("touch-action",r.touchAction)},inputs:{minW:"minW",minH:"minH",maxW:"maxW",maxH:"maxH",transition:"transition",id:"id",dragStartThreshold:"dragStartThreshold",draggable:"draggable",resizable:"resizable"},standalone:!0,features:[a.jDz],ngContentSelectors:zt,decls:3,vars:0,consts:[[1,"grid-item-resize-icon"],["resizeElem",""]],template:function(i,r){1&i&&(a.F$t(),a.Hsn(0),a._UZ(1,"div",0,1))},styles:['[_nghost-%COMP%]{display:none;position:absolute;z-index:1;overflow:hidden}[_nghost-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;-webkit-user-select:none;user-select:none;z-index:10}[_nghost-%COMP%]   div.grid-item-resize-icon[_ngcontent-%COMP%]{cursor:se-resize;width:20px;height:20px;bottom:0;right:0;color:inherit}[_nghost-%COMP%]   div.grid-item-resize-icon[_ngcontent-%COMP%]:after{content:"";position:absolute;right:3px;bottom:3px;width:5px;height:5px;border-right:2px solid;border-bottom:2px solid}.display-none[_ngcontent-%COMP%]{display:none!important}'],changeDetection:0})}return t})();function St(t){const e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}}function Kt(t,e){t===window?t.scrollBy(0,e):t.scrollTop+=e}function Xt(t,e){t===window?t.scrollBy(e,0):t.scrollLeft+=e}function Ie(t,e){let n,i,r;if(t===document){n=document.defaultView;const{width:o,height:s}=function Vt(){const t=document.defaultView||window;return{width:t.innerWidth,height:t.innerHeight}}();i={width:o,height:s,top:0,right:o,bottom:s,left:0},r=function Ae(){return Math.max(document.body.scrollWidth,document.documentElement.scrollWidth)}()}else n=t,i=St(t),r=t.scrollWidth;return null==(e=e||{}).disableHorizontal&&r<=i.width&&(e.disableHorizontal=!0),o=>o.pipe((0,W.U)(({pointerX:s,pointerY:l})=>{let h=function Oe(t,e){const{top:n,bottom:i,height:r}=t,o=.05*r;return e>=n-o&&e<=n+o?1:e>=i-o&&e<=i+o?2:0}(i,l),y=function Ge(t,e){const{left:n,right:i,width:r}=t,o=.05*r;return e>=n-o&&e<=n+o?1:e>=i-o&&e<=i+o?2:0}(i,s);return e?.disableVertical&&(h=0),e?.disableHorizontal&&(y=0),{verticalScrollDirection:h,horizontalScrollDirection:y}}),(0,ie.x)((s,l)=>s.verticalScrollDirection===l.verticalScrollDirection&&s.horizontalScrollDirection===l.horizontalScrollDirection),(0,Z.w)(({verticalScrollDirection:s,horizontalScrollDirection:l})=>s||l?function Le(t,e,n,i=2){return function T(t=0,e=C.P){return(!(0,v.k)(t)||t<0)&&(t=0),(!e||"function"!=typeof e.schedule)&&(e=C.P),new H.y(n=>(n.add(e.schedule(D,t,{subscriber:n,counter:0,period:t})),n))}(0,A.Z).pipe((0,Ht.b)(()=>{1===e?Kt(t,-i):2===e&&Kt(t,i),1===n?Xt(t,-i):2===n&&Xt(t,i)}),function Te(){return t=>t.pipe((0,G.h)(()=>!1))}())}(n,s,l,e?.scrollStep):p))}function $e(t){let e;return e=t===document?Dt():{top:t.scrollTop,left:t.scrollLeft},(0,E.R)(t,"scroll",at({capture:!0})).pipe((0,W.U)(()=>{let n,i;if(t===document){const s=Dt();n=s.top,i=s.left}else n=t.scrollTop,i=t.scrollLeft;return{top:e.top-n,left:e.left-i}}))}function Dt(){const t=document.defaultView||window,e=document.documentElement,n=e.getBoundingClientRect();return{top:-n.top||document.body.scrollTop||t.scrollY||e.scrollTop||0,left:-n.left||document.body.scrollLeft||t.scrollX||e.scrollLeft||0}}function Qt(t){const e=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*e}function Mt(t,e){return t.getPropertyValue(e).split(",").map(i=>i.trim())}function Pt(t,e){return{layout:e,layoutItem:e.find(n=>n.id===t.id),gridItemRef:t}}function Nt(t,e){const{rowHeight:n,layout:i,gap:r}=t;return"fit"===n?ft(i,e,r):n}function jt(t,e,n){const{layout:i,gap:r}=t,o=Nt(t,n),s=function Be(t,e){const{cols:n,gap:i}=t;return(e-Math.max(i*(n-1),0))/n}(t,e),l={};for(const h of i)l[h.id]={id:h.id,top:h.y*o+r*h.y,left:h.x*s+r*h.x,width:h.w*s+r*Math.max(h.w-1,0),height:h.h*o+r*Math.max(h.h-1,0)};return l}function Jt(t,e,n){return t.reduce((i,r)=>Math.max(i,(r.y+r.h)*e+Math.max(r.y+r.h-1,0)*n),0)}function kt(t){return{id:t.id,top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,height:`${t.height}px`}}function Ye(t){return function Fe(t){return function(e){return kt(t.getItemRenderData(e))}}(t)}let Ue=(()=>{class t{get compactOnPropsChange(){return this._compactOnPropsChange}set compactOnPropsChange(n){this._compactOnPropsChange=gt(n)}get preventCollision(){return this._preventCollision}set preventCollision(n){this._preventCollision=gt(n)}get scrollSpeed(){return this._scrollSpeed}set scrollSpeed(n){this._scrollSpeed=tt(n,2)}get compactType(){return this._compactType}set compactType(n){this._compactType=n}get rowHeight(){return this._rowHeight}set rowHeight(n){this._rowHeight="fit"===n?n:Math.max(1,Math.round(tt(n)))}get cols(){return this._cols}set cols(n){this._cols=Math.max(1,Math.round(tt(n)))}get layout(){return this._layout}set layout(n){this._layout=n}get gap(){return this._gap}set gap(n){this._gap=Math.max(tt(n),0)}get height(){return this._height}set height(n){this._height="number"==typeof n?Math.max(n,0):null}get backgroundConfig(){return this._backgroundConfig}set backgroundConfig(n){this._backgroundConfig=n;const i=this.elementRef.nativeElement.classList;null!==this._backgroundConfig?i.add("ktd-grid-background"):i.remove("ktd-grid-background"),this.setGridBackgroundVisible("always"===this._backgroundConfig?.show)}get config(){return{cols:this.cols,rowHeight:this.rowHeight,height:this.height,layout:this.layout,preventCollision:this.preventCollision,gap:this.gap}}constructor(n,i,r,o,s){this.gridService=n,this.elementRef=i,this.viewContainerRef=r,this.renderer=o,this.ngZone=s,this.layoutUpdated=new a.vpe,this.dragStarted=new a.vpe,this.resizeStarted=new a.vpe,this.dragEnded=new a.vpe,this.resizeEnded=new a.vpe,this.gridItemResize=new a.vpe,this.scrollableParent=null,this._compactOnPropsChange=!0,this._preventCollision=!1,this._scrollSpeed=2,this._compactType="vertical",this._rowHeight=100,this._cols=6,this._gap=0,this._height=null,this._backgroundConfig=null,this.subscriptions=[]}ngOnChanges(n){"fit"===this.rowHeight&&null==this.height&&console.warn("KtdGridComponent: The @Input() height should not be null when using rowHeight 'fit'");let i=!1,r=!1;(n.compactType||n.cols||n.layout)&&(i=!0),(i||n.rowHeight||n.height||n.gap||n.backgroundConfig)&&(r=!0),i&&this.compactOnPropsChange&&this.compactLayout(),r&&this.calculateRenderData()}ngAfterContentInit(){this.initSubscriptions()}ngAfterContentChecked(){this.render()}resize(){this.calculateRenderData(),this.render()}ngOnDestroy(){this.subscriptions.forEach(n=>n.unsubscribe())}compactLayout(){this.layout=ot(this.layout,this.compactType,this.cols)}getItemsRenderData(){return{...this._gridItemsRenderData}}getItemRenderData(n){return this._gridItemsRenderData[n]}calculateRenderData(){const n=this.elementRef.nativeElement.getBoundingClientRect();this.gridCurrentHeight=this.height??("fit"===this.rowHeight?n.height:Jt(this.layout,this.rowHeight,this.gap)),this._gridItemsRenderData=jt(this.config,n.width,this.gridCurrentHeight),this.setBackgroundCssVariables(Nt(this.config,this.gridCurrentHeight))}render(){this.renderer.setStyle(this.elementRef.nativeElement,"height",`${this.gridCurrentHeight}px`),this.updateGridItemsStyles()}setBackgroundCssVariables(n){const i=this.elementRef.nativeElement.style;this._backgroundConfig?(i.setProperty("--gap",this.gap+"px"),i.setProperty("--row-height",n+"px"),i.setProperty("--columns",`${this.cols}`),i.setProperty("--border-width",(this._backgroundConfig.borderWidth??1)+"px"),i.setProperty("--border-color",this._backgroundConfig.borderColor??"#ffa72678"),i.setProperty("--gap-color",this._backgroundConfig.gapColor??"transparent"),i.setProperty("--row-color",this._backgroundConfig.rowColor??"transparent"),i.setProperty("--column-color",this._backgroundConfig.columnColor??"transparent")):(i.removeProperty("--gap"),i.removeProperty("--row-height"),i.removeProperty("--columns"),i.removeProperty("--border-width"),i.removeProperty("--border-color"),i.removeProperty("--gap-color"),i.removeProperty("--row-color"),i.removeProperty("--column-color"))}updateGridItemsStyles(){this._gridItems.forEach(n=>{const i=this._gridItemsRenderData[n.id];null==i?console.error(`Couldn't find the specified grid item for the id: ${n.id}`):n.setStyles(kt(i))})}setGridBackgroundVisible(n){const i=this.elementRef.nativeElement.classList;n?i.add("ktd-grid-background-visible"):i.remove("ktd-grid-background-visible")}initSubscriptions(){this.subscriptions=[this._gridItems.changes.pipe((0,rt.O)(this._gridItems),(0,Z.w)(n=>(0,_.T)(...n.map(i=>i.dragStart$.pipe((0,W.U)(r=>({event:r,gridItem:i,type:"drag"})))),...n.map(i=>i.resizeStart$.pipe((0,W.U)(r=>({event:r,gridItem:i,type:"resize"}))))).pipe(yt(({event:i,gridItem:r,type:o})=>(this.ngZone.run(()=>("drag"===o?this.dragStarted:this.resizeStarted).emit(Pt(r,this.layout))),this.setGridBackgroundVisible("whenDragging"===this._backgroundConfig?.show||"always"===this._backgroundConfig?.show),this.performDragSequence$(r,i,o).pipe((0,W.U)(s=>({layout:s,gridItem:r,type:o})))))))).subscribe(({layout:n,gridItem:i,type:r})=>{this.layout=n,this.calculateRenderData(),("drag"===r?this.dragEnded:this.resizeEnded).emit(Pt(i,n)),this.layoutUpdated.emit(n),this.setGridBackgroundVisible("always"===this._backgroundConfig?.show)})]}performDragSequence$(n,i,r){return new H.y(o=>{const s=St(this.elementRef.nativeElement),l=St(n.elementRef.nativeElement),h="string"==typeof this.scrollableParent?document.getElementById(this.scrollableParent):this.scrollableParent;this.renderer.addClass(n.elementRef.nativeElement,"no-transitions"),this.renderer.addClass(n.elementRef.nativeElement,"ktd-grid-item-dragging");const y={...l,left:l.left-s.left,top:l.top-s.top};let w;this.createPlaceholderElement(y,n.placeholder);const L=this.ngZone.runOutsideAngular(()=>(h?this.gridService.mouseOrTouchMove$(document).pipe((0,W.U)(m=>({pointerX:J(m),pointerY:q(m)})),Ie(h,{scrollStep:this.scrollSpeed})):p).pipe((0,vt.R)(Ct(document))).subscribe()),I=this.ngZone.runOutsideAngular(()=>(0,_.T)((0,M.aj)([this.gridService.mouseOrTouchMove$(document),...h?[$e(h).pipe((0,rt.O)({top:0,left:0}))]:[(0,pt.of)({top:0,left:0})]])).pipe((0,vt.R)(Ct(document))).subscribe(([m,U])=>{m.preventDefault();const S=w||this.layout,nt="drag"===r?Re:Se,{layout:X,draggedItemPos:V}=nt(n,{layout:S,rowHeight:this.rowHeight,height:this.height,cols:this.cols,preventCollision:this.preventCollision,gap:this.gap},this.compactType,{pointerDownEvent:i,pointerDragEvent:m,gridElemClientRect:s,dragElemClientRect:l,scrollDifference:U});w=X,this.gridCurrentHeight=this.height??("fit"===this.rowHeight?s.height:Jt(w,this.rowHeight,this.gap)),this._gridItemsRenderData=jt({cols:this.cols,rowHeight:this.rowHeight,height:this.height,layout:w,preventCollision:this.preventCollision,gap:this.gap},s.width,s.height);const B={...this._gridItemsRenderData[n.id]},u=kt(B);this.placeholder.style.width=u.width,this.placeholder.style.height=u.height,this.placeholder.style.transform=`translateX(${u.left}) translateY(${u.top})`,this._gridItemsRenderData[n.id]={...V,id:this._gridItemsRenderData[n.id].id},this.setBackgroundCssVariables("fit"===this.rowHeight?ft(w,s.height,this.gap):this.rowHeight),this.render(),"resize"===r&&(function Me(t,e){return t.id===e.id&&t.x===e.x&&t.y===e.y&&t.w===e.w&&t.h===e.h}(S.find(F=>F.id===n.id),w.find(F=>F.id===n.id))||this.gridItemResize.emit({width:B.width,height:B.height,gridItemRef:Pt(n,w).gridItemRef}))},m=>o.error(m),()=>{this.ngZone.run(()=>{this.renderer.removeClass(n.elementRef.nativeElement,"no-transitions"),this.renderer.removeClass(n.elementRef.nativeElement,"ktd-grid-item-dragging"),this.addGridItemAnimatingClass(n).subscribe(),this.destroyPlaceholder(),o.next(w?w.map(m=>({id:m.id,x:m.x,y:m.y,w:m.w,h:m.h,minW:m.minW,minH:m.minH,maxW:m.maxW,maxH:m.maxH})):this.layout),o.complete()})}));return()=>{L.unsubscribe(),I.unsubscribe()}})}addGridItemAnimatingClass(n){return new H.y(i=>{const r=function We(t){const e=getComputedStyle(t),n=Mt(e,"transition-property"),i=n.find(l=>"transform"===l||"all"===l);if(!i)return 0;const r=n.indexOf(i),o=Mt(e,"transition-duration"),s=Mt(e,"transition-delay");return Qt(o[r])+Qt(s[r])}(n.elementRef.nativeElement);if(0===r)return i.next(),void i.complete();this.renderer.addClass(n.elementRef.nativeElement,"ktd-grid-item-animating");const o=h=>{(!h||h.target===n.elementRef.nativeElement&&"transform"===h.propertyName)&&(this.renderer.removeClass(n.elementRef.nativeElement,"ktd-grid-item-animating"),l(),clearTimeout(s),i.next(),i.complete())},s=setTimeout(o,1.5*r),l=this.renderer.listen(n.elementRef.nativeElement,"transitionend",o)})}createPlaceholderElement(n,i){this.placeholder=this.renderer.createElement("div"),this.placeholder.style.width=`${n.width}px`,this.placeholder.style.height=`${n.height}px`,this.placeholder.style.transform=`translateX(${n.left}px) translateY(${n.top}px)`,this.placeholder.classList.add("ktd-grid-item-placeholder"),this.renderer.appendChild(this.elementRef.nativeElement,this.placeholder),i?(this.placeholderRef=this.viewContainerRef.createEmbeddedView(i.templateRef,i.data),this.placeholderRef.rootNodes.forEach(r=>this.placeholder.appendChild(r)),this.placeholderRef.detectChanges()):this.placeholder.classList.add("ktd-grid-item-placeholder-default")}destroyPlaceholder(){this.placeholder?.remove(),this.placeholderRef?.destroy(),this.placeholder=this.placeholderRef=null}static#t=this.\u0275fac=function(i){return new(i||t)(a.Y36(Rt),a.Y36(a.SBq),a.Y36(a.s_b),a.Y36(a.Qsj),a.Y36(a.R0b))};static#e=this.\u0275cmp=a.Xpm({type:t,selectors:[["ktd-grid"]],contentQueries:function(i,r,o){if(1&i&&a.Suo(o,Ut,5),2&i){let s;a.iGM(s=a.CRH())&&(r._gridItems=s)}},inputs:{scrollableParent:"scrollableParent",compactOnPropsChange:"compactOnPropsChange",preventCollision:"preventCollision",scrollSpeed:"scrollSpeed",compactType:"compactType",rowHeight:"rowHeight",cols:"cols",layout:"layout",gap:"gap",height:"height",backgroundConfig:"backgroundConfig"},outputs:{layoutUpdated:"layoutUpdated",dragStarted:"dragStarted",resizeStarted:"resizeStarted",dragEnded:"dragEnded",resizeEnded:"resizeEnded",gridItemResize:"gridItemResize"},standalone:!0,features:[a._Bn([{provide:Yt,useFactory:Ye,deps:[t]}]),a.TTD,a.jDz],ngContentSelectors:zt,decls:1,vars:0,template:function(i,r){1&i&&(a.F$t(),a.Hsn(0))},styles:['ktd-grid{display:block;position:relative;width:100%}ktd-grid.ktd-grid-background:before{content:"";border:none;position:absolute;inset:0;z-index:0;transition:opacity .2s;opacity:0;background-image:repeating-linear-gradient(var(--border-color) 0 var(--border-width),var(--row-color) var(--border-width) calc(var(--row-height) - var(--border-width)),var(--border-color) calc(var(--row-height) - var(--border-width)) calc(var(--row-height)),var(--gap-color) calc(var(--row-height)) calc(var(--row-height) + var(--gap))),repeating-linear-gradient(90deg,var(--border-color) 0 var(--border-width),var(--column-color) var(--border-width) calc(100% - (var(--border-width) + var(--gap))),var(--border-color) calc(100% - (var(--border-width) + var(--gap))) calc(100% - var(--gap)),var(--gap-color) calc(100% - var(--gap)) 100%);background-size:calc((100% + var(--gap)) / var(--columns)) calc(var(--row-height) + var(--gap));background-position:0 0}ktd-grid.ktd-grid-background.ktd-grid-background-visible:before{opacity:1}ktd-grid ktd-grid-item.ktd-grid-item-dragging,ktd-grid ktd-grid-item.ktd-grid-item-animating{z-index:1000}ktd-grid ktd-grid-item.no-transitions{transition:none!important}ktd-grid .ktd-grid-item-placeholder{position:absolute;z-index:0;transition-property:transform;transition:all .15s ease}ktd-grid .ktd-grid-item-placeholder-default{background-color:#8b0000;opacity:.6}\n'],encapsulation:2,changeDetection:0})}return t})(),Ze=(()=>{class t{static#t=this.\u0275fac=function(i){return new(i||t)};static#e=this.\u0275mod=a.oAB({type:t});static#n=this.\u0275inj=a.cJS({providers:[Rt]})}return t})()}}]);